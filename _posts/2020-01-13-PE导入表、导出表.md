---
title: PE导出表
date: 2020-1-13
categories: 
- PE
tags: 
- 导出表
---

# 目的
在程序正确运行的前提下，移动各种表
- 一个程序有很多PE文件组成
- 导出表记录函数、函数地址
- 一般情况下exe（大多数情况没用导出表，只用别人提供的函数）、dll都可以提供函数给其他函数用。

1. 可选PE头，数据目录项的第一个数据
2. RVA转化为FOA

```
typedef struct _IMAGE_EXPORT_DIRECTORY {
    DWORD   Characteristics;
    DWORD   TimeDateStamp;
    WORD    MajorVersion;
    WORD    MinorVersion;
    DWORD   Name;
    DWORD   Base;
    DWORD   NumberOfFunctions;   //所有导出函数的个数
    DWORD   NumberOfNames;
    DWORD   AddressOfFunctions;     // RVA from base of image 函数地址
    DWORD   AddressOfNames;         // RVA from base of image 函数名称，叫这个名字的函数存在哪里
    DWORD   AddressOfNameOrdinals;  // RVA from base of image 函数序号
} IMAGE_EXPORT_DIRECTORY, *PIMAGE_EXPORT_DIRECTORY;
```