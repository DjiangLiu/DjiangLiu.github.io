---
title: C宏与条件编译
date: 2020-2-16
categories: 
- C基础
tags: 
- 宏
- 条件编译
---

# 宏定义
1. 用一个标志符代表一个字符串。该标志符就称为宏名
2. 在程序编译预处理阶段，所有红名将会被替换为宏定义中的字符串，这个操作叫做宏展开
3. #define 宏名 字符串
4. #define 宏名(参数表) 字符串
5. 宏名大写
6. a.c (预处理) a.i (编译) a.s (汇编) a.o (链接) a.exe

```c
#include<stdio.h>

#define PI 3.14f
void Test()
{
	printf("%f", PI * 2 * 2);
}

int main(void)
{
	Test();
}
```

1. 有意义
2. 减少修改
3. 无类型检查
4. 无法调试
5. 宏 不是变量，没有类型，也无法调试

```c
const float PI = 3.14f
```
1. 有意义
2. 减少修改
3. 有类型
4. 可调式

```c
#include<stdio.h>

#define MAX(x,y) x>y?x:y

void Test()
{
	printf("%d\n", MAX(2, 3));
	printf("%d\n", MAX(1 & 7, 5 - 1));
    //宏展开是原封不动的展开。  1&7>5-1?1&7:5-1  --> 1&7>4?1:4 --> 1&1?1:4
}

int main(void)
{
	Test();
}

3
1

#include<stdio.h>

#define MAX(x,y) (x)>(y)?(x):(y)

void Test()
{
	printf("%d\n", MAX(2, 3));
	printf("%d\n", MAX(1 & 7, 5 - 1));
}

int main(void)
{
	Test();
}
```