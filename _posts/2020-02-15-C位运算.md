---
title: C位运算
date: 2020-2-15
categories: 
- C基础
tags: 
- 位运算
---

# 概述
直接对整数在内存中的二进制位进行操作。效率更高
1. 与 and &
2. 或 or |
3. 取反 not ~
4. 异或 xor ^
5. 左移 shl <<
6. 右移 shr >>
7. 逻辑与 && 逻辑或|| 逻辑取反！ 

# 与运算
二进制数计算，都为1.则为1。

```c
    1111
&   1001
--------
    1001
```
## 作用
1. 获取其中几位。
2. IP & 子网掩码
3. 获取一个数字中有多少个1。整数a二进制中最右边的1

    a&(a-1)

# 或运算
二进制数计算，都为0，则为0。

```c
    1111
|   1001
--------
    1111
```

# 异或运算
1. 二进制数计算，相同为0，不同为1。任何数和0异或等于自身，与自身异或等于0。
2. 可以在不添加临时变量的情况下交换两个数
3. 单指针实现双链表（后续加强）


```c
    1111
^   1001
--------
    0110
```

```c
a = a^b;
b = a^b;
a = a^b;

a = a+b;
b = a-b;
a = a-b;
```

# 取反运算
1. 1变成0，0变成1
2. 一目运算  没有~=

```c
~   1001
--------
    0110
```

# 移位运算
## 左移
1. *a左移n位 a<<n 赋值a<<=n*
2. 一个正数左移n位 相当于 乘以 2^n
3. 补码  绝对值 取反 +1
4. -47<<2 == 68

```c
	char a = -47;
	char b = a << 2;
	printf("%d\n", b);
	short x = -47;
	short y = a << 2;
	printf("%d\n", y);

    注意长度溢出
    68
    -188
```

## 右移
1. 逻辑右移  左边填0
2. 算术右移  左边填符号位。
3. c语言中用算术右移
4. 一个正数右移n位 相当于 除以 2^n

# 作业
1. 0x12345678 | ~0xFFFEFFFF  == 12355678
2. （0x12345678>>24）&0xff == 18

```c
    0001 0010 0011 0100 0101 0110 0111 1000 >> 24 == 0001 0010
    0001 0010
&   1111 1111
-------------
    0001 0010


18
```

# 位运算综合应用
1. 置0置1.

```c
#include<stdio.h>

#define SETFLAG(a,n) ((a)|=(1<<n))//把整数a中的第n位置为1.
#define CLEARFLAG(a,n) ((a)&=~(1<<(n)))//把整数a中第n位置位0
#define FLAGON(a,n) ((a)&(1<<(n)))//判断a中第n位是否为1
#define BIT(n) (1<<n)

int main(void)
{
	int i = 10;
	printf("%d\n", FLAGON(i, 3));
	//置1
	i |= BIT(3);
	//置0
	i &= ~BIT(3);
	//判断是否为1
	i& BIT(3);
}
```

2. 对称加密

```c
B = A^key
A = B^key
```