---
title: 进程模块隐藏
date: 2020-4-12
categories: 
- 进程模块隐藏
tags: 
- ShellCode
- 进程模块隐藏
---

# 进程隐藏1
1. 新建B.exe将ImageBase调高 0x2000000(高空运行)。
2. 读取A.exe 拉伸、复制到0x400000。
3. 根据B.exe的导入表，修复A的IAT表。
   1. DLL的名字。
   2. 该DLL的函数名或者序号。
   3. IAT = GetProcessAddr(LoadLibary(DLL名称),函数名称或者函数序号)。
4. 调到A的入口处执行。

# 进程隐藏2
1. 获得自身的句柄。
2. 得到字节的ImageBase和SizeOfimage。
3. 创建一个新的缓冲区、将自己复制进去。
4. 打开要注入的A进程。
5. 在A进程中申请内存，大小是SizeOfImage。
6. 修复进程B的重定位表。（只要修复了重定位表，IAT表也就修复了）
7. 将复制后的数据，复制到A的内存中。
8. 创建一个远程线程执行进程B的进程。

