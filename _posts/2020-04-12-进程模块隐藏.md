---
title: 进程模块隐藏
date: 2020-4-12
categories: 
- 进程模块隐藏
tags: 
- ShellCode
- 进程模块隐藏
---

# 进程的执行
1. 通过context进行执行。

# 进程隐藏1
1. 新建B.exe将ImageBase调高 0x2000000(高空运行)。
2. 读取A.exe 拉伸、复制到0x400000。
3. 根据B.exe的导入表，修复A的IAT表。
   1. DLL的名字。
   2. 该DLL的函数名或者序号。
   3. IAT = GetProcessAddr(LoadLibary(DLL名称),函数名称或者函数序号)。
4. 调到A的入口处执行。

# 进程隐藏2
## 进程B
1. 创建一个函数Entry
   1. 修复进程B的IAT表
   2. 所谓的修复IAT表，不是把 412345 改成 512345 而是改 512345里面存的值。改512345是重定位表的任务。
   3. 需要把进程B用到的函数地址，改成A进程中的地址。
2. 获得自身的句柄。
3. 得到字节的ImageBase和SizeOfimage。
4. 创建一个新的缓冲区、将自己复制进去。
5. 打开要注入的A进程。
6. 在A进程中申请内存，大小B的是SizeOfImage。
7. 修复进程B的重定位表。（只要修复了重定位表，IAT表也就修复了）
8. 将复制后的数据，复制到A的内存中。
9. 创建一个远程线程执行进程B的Entry。

